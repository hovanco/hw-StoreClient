{"ast":null,"code":"var _jsxFileName = \"/Users/mac3/Desktop/workspace/StoreClient/src/pages/setting/account-detail/index.tsx\",\n    _s = $RefreshSig$();\n\nimport { DeleteOutlined, ExclamationCircleOutlined, SaveOutlined } from '@ant-design/icons';\nimport { Button, Card, Col, Empty, Form, Input, message, Modal, Row, Select, Space } from 'antd';\nimport { useForm } from 'antd/es/form/Form';\nimport Title from 'antd/lib/typography/Title';\nimport pick from 'lodash/pick';\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link, useHistory, useParams } from 'react-router-dom';\nimport staffsApi from '../../../api/staff-api';\nimport { BackLink, Loading, PageTopWrapper } from '../../../components';\nimport rules from '../../../helper/rules';\nimport { DefaultLayout } from '../../../layout';\nimport { EUserRole } from '../../../models';\nimport { getUserAction } from '../../../reducers/authState/authAction';\nimport { listStaffs } from '../account/components/staff-table';\nimport RemoveAccount from './components/remove-account';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst AccountdDetail = () => {\n  _s();\n\n  const history = useHistory();\n  const dispatch = useDispatch();\n  const store = useSelector(state => state.store.data);\n  const user = useSelector(state => state.auth.user);\n  const {\n    staffId\n  } = useParams();\n  const [loading, setLoading] = useState(true);\n  const [submiting, setSubmiting] = useState(false);\n  const [staff, setStaff] = useState();\n  const [form] = useForm();\n  const loadStaff = useCallback(async id => {\n    try {\n      const response = await staffsApi.getStaff(store._id, id);\n      setStaff(response);\n    } catch (error) {} finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const onFinish = async values => {\n    try {\n      setSubmiting(true);\n      await staffsApi.updateStaff(store._id, staffId, { ...pick(values, ['name', 'role', 'phoneNo'])\n      });\n      setStaff({\n        _id: staffId,\n        ...pick(values, ['name', 'role', 'email', 'phoneNo'])\n      });\n\n      if (staffId === user._id) {\n        dispatch(getUserAction());\n      }\n\n      message.success('Chỉnh sửa thành công');\n    } catch (error) {\n      message.error('Lỗi chỉnh sửa');\n    } finally {\n      setSubmiting(false);\n    }\n  };\n\n  const onReset = () => {\n    form.resetFields();\n  };\n\n  const handleRemoveStaff = () => {\n    Modal.confirm({\n      title: 'Gỡ tài khoản',\n      icon: /*#__PURE__*/_jsxDEV(ExclamationCircleOutlined, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 19\n      }, this),\n      content: 'Bạn chắc chắn muốn xóa nhân viên?',\n      okText: 'Xóa',\n      cancelText: 'Hủy',\n      onOk: async () => {\n        try {\n          await staffsApi.deleteStaff(store._id, staffId);\n          message.success('Đã gỡ tài khoản thành công');\n          history.push('/setting/account');\n        } catch (error) {\n          message.error('Lỗi gỡ tài khoản');\n        } finally {}\n      }\n    });\n  };\n\n  useEffect(() => {\n    if (staffId) {\n      loadStaff(staffId);\n    } else {\n      setLoading(false);\n    }\n  }, [staffId]);\n\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(Loading, {\n      full: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 16\n    }, this);\n  }\n\n  if (!staff) {\n    return /*#__PURE__*/_jsxDEV(DefaultLayout, {\n      title: \"Nh\\xE2n vi\\xEAn kh\\xF4ng t\\u1ED3n t\\u1EA1i\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"content \",\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          children: /*#__PURE__*/_jsxDEV(Empty, {\n            image: Empty.PRESENTED_IMAGE_SIMPLE,\n            description: \"Nh\\xE2n vi\\xEAn kh\\xF4ng t\\u1ED3n t\\u1EA1i\",\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              to: \"/setting/account\",\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                type: \"primary\",\n                danger: true,\n                children: \"Quay l\\u1EA1i\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 124,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }, this);\n  }\n\n  const title = staff.name.toLowerCase();\n  return /*#__PURE__*/_jsxDEV(Form, {\n    layout: \"vertical\",\n    form: form,\n    onFinish: onFinish,\n    initialValues: { ...pick(staff, ['name', 'phoneNo', 'email', 'role'])\n    },\n    children: /*#__PURE__*/_jsxDEV(DefaultLayout, {\n      title: title,\n      children: [/*#__PURE__*/_jsxDEV(PageTopWrapper, {\n        leftContent: /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(BackLink, {\n            to: \"/setting/account\",\n            text: \"C\\xE0i \\u0111\\u1EB7t t\\xE0i kho\\u1EA3n\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(Title, {\n            level: 3,\n            children: title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true),\n        rightContent: /*#__PURE__*/_jsxDEV(Space, {\n          children: [/*#__PURE__*/_jsxDEV(RemoveAccount, {\n            staffId: staff._id,\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              type: \"primary\",\n              danger: true,\n              icon: /*#__PURE__*/_jsxDEV(DeleteOutlined, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 159,\n                columnNumber: 43\n              }, this),\n              disabled: submiting,\n              onClick: handleRemoveStaff,\n              children: \"G\\u1EE1 b\\u1ECF t\\xE0i kho\\u1EA3n\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            type: \"primary\",\n            htmlType: \"submit\",\n            icon: /*#__PURE__*/_jsxDEV(SaveOutlined, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 39\n            }, this),\n            loading: submiting,\n            children: \"L\\u01B0u\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"content\",\n        children: [/*#__PURE__*/_jsxDEV(Row, {\n          gutter: 15,\n          children: [/*#__PURE__*/_jsxDEV(Col, {\n            span: 16,\n            children: /*#__PURE__*/_jsxDEV(Card, {\n              type: \"inner\",\n              title: \"H\\u1ED3 s\\u01A1 nh\\xE2n vi\\xEAn\",\n              children: /*#__PURE__*/_jsxDEV(Row, {\n                gutter: 30,\n                children: [/*#__PURE__*/_jsxDEV(Col, {\n                  span: 12,\n                  children: /*#__PURE__*/_jsxDEV(Form.Item, {\n                    name: \"name\",\n                    label: \"T\\xEAn nh\\xE2n vi\\xEAn\",\n                    rules: [{\n                      required: true,\n                      message: 'Vui lòng nhập Tên nhân viên'\n                    }],\n                    children: /*#__PURE__*/_jsxDEV(Input, {\n                      placeholder: \"\\u0110i\\u1EC1n t\\xEAn nh\\xE2n vi\\xEAn\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 194,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 184,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 183,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(Col, {\n                  span: 12,\n                  children: /*#__PURE__*/_jsxDEV(Form.Item, {\n                    name: \"email\",\n                    label: \"Email\",\n                    rules: [{\n                      required: true,\n                      message: 'Điền email nhân viên'\n                    }],\n                    children: /*#__PURE__*/_jsxDEV(Input, {\n                      placeholder: \"\\u0110i\\u1EC1n email nh\\xE2n vi\\xEAn\",\n                      disabled: true\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 208,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 198,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 197,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(Col, {\n                  span: 12,\n                  children: /*#__PURE__*/_jsxDEV(Form.Item, {\n                    name: \"phoneNo\",\n                    label: \"S\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\",\n                    rules: [{\n                      required: true,\n                      message: 'Vui lòng nhập Số điện thoại'\n                    }, {\n                      validator: rules.validatePhone\n                    }],\n                    children: /*#__PURE__*/_jsxDEV(Input, {\n                      placeholder: \"\\u0110i\\u1EC1n s\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i nh\\xE2n vi\\xEAn\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 222,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 212,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 211,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 182,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            span: 8,\n            children: /*#__PURE__*/_jsxDEV(Card, {\n              type: \"inner\",\n              title: \"Ph\\xE2n quy\\u1EC1n vai tr\\xF2\",\n              children: /*#__PURE__*/_jsxDEV(Form.Item, {\n                name: \"role\",\n                children: /*#__PURE__*/_jsxDEV(Select, {\n                  style: {\n                    width: '100%'\n                  },\n                  placeholder: \"Ph\\xE2n quy\\u1EC1n cho nh\\xE2n vi\\xEAn\",\n                  children: [/*#__PURE__*/_jsxDEV(Select.Option, {\n                    value: \"-1\",\n                    disabled: true,\n                    children: \"Ph\\xE2n quy\\u1EC1n cho nh\\xE2n vi\\xEAn\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 235,\n                    columnNumber: 41\n                  }, this), listStaffs.map(item => /*#__PURE__*/_jsxDEV(Select.Option, {\n                    value: item.role,\n                    disabled: item.role === EUserRole.owner,\n                    children: item.title\n                  }, item.role, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 239,\n                    columnNumber: 45\n                  }, this))]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 231,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 230,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n          style: {\n            marginTop: 15\n          },\n          children: /*#__PURE__*/_jsxDEV(Row, {\n            gutter: 15,\n            justify: \"end\",\n            children: [/*#__PURE__*/_jsxDEV(Col, {\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                onClick: onReset,\n                children: \"H\\u1EE7y\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 256,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 255,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                type: \"primary\",\n                htmlType: \"submit\",\n                icon: /*#__PURE__*/_jsxDEV(SaveOutlined, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 262,\n                  columnNumber: 43\n                }, this),\n                loading: submiting,\n                children: \"L\\u01B0u\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 259,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 258,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 138,\n    columnNumber: 9\n  }, this);\n};\n\n_s(AccountdDetail, \"IMK4F3l3SJzyv8AqTEWoxhS1AEU=\", false, function () {\n  return [useHistory, useDispatch, useSelector, useSelector, useParams, useForm];\n});\n\n_c = AccountdDetail;\nexport default AccountdDetail;\n\nvar _c;\n\n$RefreshReg$(_c, \"AccountdDetail\");","map":{"version":3,"sources":["/Users/mac3/Desktop/workspace/StoreClient/src/pages/setting/account-detail/index.tsx"],"names":["DeleteOutlined","ExclamationCircleOutlined","SaveOutlined","Button","Card","Col","Empty","Form","Input","message","Modal","Row","Select","Space","useForm","Title","pick","React","useCallback","useEffect","useState","useDispatch","useSelector","Link","useHistory","useParams","staffsApi","BackLink","Loading","PageTopWrapper","rules","DefaultLayout","EUserRole","getUserAction","listStaffs","RemoveAccount","AccountdDetail","history","dispatch","store","state","data","user","auth","staffId","loading","setLoading","submiting","setSubmiting","staff","setStaff","form","loadStaff","id","response","getStaff","_id","error","onFinish","values","updateStaff","success","onReset","resetFields","handleRemoveStaff","confirm","title","icon","content","okText","cancelText","onOk","deleteStaff","push","PRESENTED_IMAGE_SIMPLE","name","toLowerCase","required","validator","validatePhone","width","map","item","role","owner","marginTop"],"mappings":"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","sourcesContent":["import { DeleteOutlined, ExclamationCircleOutlined, SaveOutlined } from '@ant-design/icons';\nimport { Button, Card, Col, Empty, Form, Input, message, Modal, Row, Select, Space } from 'antd';\nimport { useForm } from 'antd/es/form/Form';\nimport Title from 'antd/lib/typography/Title';\nimport pick from 'lodash/pick';\nimport React, { FC, useCallback, useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link, useHistory, useParams } from 'react-router-dom';\nimport staffsApi from '../../../api/staff-api';\nimport { BackLink, Loading, PageTopWrapper } from '../../../components';\nimport rules from '../../../helper/rules';\nimport { DefaultLayout } from '../../../layout';\nimport { EUserRole, IStaff } from '../../../models';\nimport { getUserAction } from '../../../reducers/authState/authAction';\nimport { IState } from '../../../store/rootReducer';\nimport { listStaffs } from '../account/components/staff-table';\nimport RemoveAccount from './components/remove-account';\n\ninterface IParams {\n    staffId: string;\n}\n\ninterface FormData {\n    name: string;\n    email: string;\n    password: string;\n    phoneNo: string;\n    role: EUserRole;\n}\nconst AccountdDetail: FC = () => {\n    const history = useHistory();\n    const dispatch = useDispatch();\n    const store = useSelector((state: IState) => state.store.data);\n    const user = useSelector((state: IState) => state.auth.user);\n\n    const { staffId } = useParams<IParams>();\n    const [loading, setLoading] = useState<boolean>(true);\n    const [submiting, setSubmiting] = useState<boolean>(false);\n    const [staff, setStaff] = useState<IStaff>();\n    const [form] = useForm();\n\n    const loadStaff = useCallback(async (id: string) => {\n        try {\n            const response = await staffsApi.getStaff(store._id as string, id);\n\n            setStaff(response);\n        } catch (error) {\n        } finally {\n            setLoading(false);\n        }\n    }, []);\n\n    const onFinish = async (values: FormData) => {\n        try {\n            setSubmiting(true);\n\n            await staffsApi.updateStaff(store._id as string, staffId as string, {\n                ...pick(values, ['name', 'role', 'phoneNo']),\n            });\n\n            setStaff({\n                _id: staffId,\n                ...pick(values, ['name', 'role', 'email', 'phoneNo']),\n            });\n\n            if (staffId === user._id) {\n                dispatch(getUserAction());\n            }\n\n            message.success('Chỉnh sửa thành công');\n        } catch (error) {\n            message.error('Lỗi chỉnh sửa');\n        } finally {\n            setSubmiting(false);\n        }\n    };\n\n    const onReset = () => {\n        form.resetFields();\n    };\n\n    const handleRemoveStaff = () => {\n        Modal.confirm({\n            title: 'Gỡ tài khoản',\n            icon: <ExclamationCircleOutlined />,\n            content: 'Bạn chắc chắn muốn xóa nhân viên?',\n            okText: 'Xóa',\n            cancelText: 'Hủy',\n            onOk: async () => {\n                try {\n                    await staffsApi.deleteStaff(store._id as string, staffId as string);\n                    message.success('Đã gỡ tài khoản thành công');\n                    history.push('/setting/account');\n                } catch (error) {\n                    message.error('Lỗi gỡ tài khoản');\n                } finally {\n                }\n            },\n        });\n    };\n\n    useEffect(() => {\n        if (staffId) {\n            loadStaff(staffId);\n        } else {\n            setLoading(false);\n        }\n    }, [staffId]);\n\n    if (loading) {\n        return <Loading full />;\n    }\n\n    if (!staff) {\n        return (\n            <DefaultLayout title=\"Nhân viên không tồn tại\">\n                <div className=\"content \">\n                    <Card>\n                        <Empty\n                            image={Empty.PRESENTED_IMAGE_SIMPLE}\n                            description=\"Nhân viên không tồn tại\"\n                        >\n                            <Link to=\"/setting/account\">\n                                <Button type=\"primary\" danger>\n                                    Quay lại\n                                </Button>\n                            </Link>\n                        </Empty>\n                    </Card>\n                </div>\n            </DefaultLayout>\n        );\n    }\n\n    const title = staff.name.toLowerCase();\n\n    return (\n        <Form\n            layout='vertical'\n            form={form}\n            onFinish={onFinish}\n            initialValues={{ ...pick(staff, ['name', 'phoneNo', 'email', 'role']) }}\n        >\n            <DefaultLayout title={title}>\n                <PageTopWrapper\n                    leftContent={\n                        <>\n                            <BackLink to='/setting/account' text='Cài đặt tài khoản' />\n\n                            <Title level={3}>{title}</Title>\n                        </>\n                    }\n                    rightContent={\n                        <Space>\n                            <RemoveAccount staffId={staff._id}>\n                                <Button\n                                    type='primary'\n                                    danger\n                                    icon={<DeleteOutlined />}\n                                    disabled={submiting}\n                                    onClick={handleRemoveStaff}\n                                >\n                                    Gỡ bỏ tài khoản\n                                </Button>\n                            </RemoveAccount>\n\n                            <Button\n                                type='primary'\n                                htmlType='submit'\n                                icon={<SaveOutlined />}\n                                loading={submiting}\n                            >\n                                Lưu\n                            </Button>\n                        </Space>\n                    }\n                />\n                <div className='content'>\n                    <Row gutter={15}>\n                        <Col span={16}>\n                            <Card type='inner' title='Hồ sơ nhân viên'>\n                                <Row gutter={30}>\n                                    <Col span={12}>\n                                        <Form.Item\n                                            name='name'\n                                            label='Tên nhân viên'\n                                            rules={[\n                                                {\n                                                    required: true,\n                                                    message: 'Vui lòng nhập Tên nhân viên',\n                                                },\n                                            ]}\n                                        >\n                                            <Input placeholder='Điền tên nhân viên' />\n                                        </Form.Item>\n                                    </Col>\n                                    <Col span={12}>\n                                        <Form.Item\n                                            name='email'\n                                            label='Email'\n                                            rules={[\n                                                {\n                                                    required: true,\n                                                    message: 'Điền email nhân viên',\n                                                },\n                                            ]}\n                                        >\n                                            <Input placeholder='Điền email nhân viên' disabled />\n                                        </Form.Item>\n                                    </Col>\n                                    <Col span={12}>\n                                        <Form.Item\n                                            name='phoneNo'\n                                            label='Số điện thoại'\n                                            rules={[\n                                                { required: true, message: 'Vui lòng nhập Số điện thoại' },\n                                                {\n                                                    validator: rules.validatePhone,\n                                                },\n                                            ]}\n                                        >\n                                            <Input placeholder='Điền số điện thoại nhân viên' />\n                                        </Form.Item>\n                                    </Col>\n                                </Row>\n                            </Card>\n                        </Col>\n                        <Col span={8}>\n                            <Card type='inner' title='Phân quyền vai trò'>\n                                <Form.Item name='role'>\n                                    <Select\n                                        style={{ width: '100%' }}\n                                        placeholder='Phân quyền cho nhân viên'\n                                    >\n                                        <Select.Option value='-1' disabled>\n                                            Phân quyền cho nhân viên\n                                        </Select.Option>\n                                        {listStaffs.map((item) => (\n                                            <Select.Option\n                                                value={item.role}\n                                                key={item.role}\n                                                disabled={item.role === EUserRole.owner}\n                                            >\n                                                {item.title}\n                                            </Select.Option>\n                                        ))}\n                                    </Select>\n                                </Form.Item>\n                            </Card>\n                        </Col>\n                    </Row>\n\n                    <Form.Item style={{ marginTop: 15 }}>\n                        <Row gutter={15} justify='end'>\n                            <Col>\n                                <Button onClick={onReset}>Hủy</Button>\n                            </Col>\n                            <Col>\n                                <Button\n                                    type='primary'\n                                    htmlType='submit'\n                                    icon={<SaveOutlined />}\n                                    loading={submiting}\n                                >\n                                    Lưu\n                                </Button>\n                            </Col>\n                        </Row>\n                    </Form.Item>\n                </div>\n            </DefaultLayout>\n        </Form>\n    );\n};\n\nexport default AccountdDetail;\n"]},"metadata":{},"sourceType":"module"}