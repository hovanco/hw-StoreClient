{"ast":null,"code":"import { push } from 'connected-react-router';\nimport { loginApi } from '../../api';\nimport authApi from '../../api/auth-api';\nimport { getToken, removeToken } from '../../api/token';\nimport { getUserApi } from '../../api/user';\nimport types from './authTypes'; // load user\n\nconst loadingUser = () => ({\n  type: types.LOADING\n});\n\nexport const loadUserSuccess = payload => ({\n  type: types.LOAD_USER_SUCCESS,\n  payload\n});\nexport const getUserAction = () => async (dispatch, getState) => {\n  try {\n    dispatch(loadingUser());\n    const res = await getUserApi();\n    await dispatch(loadUserSuccess(res.data));\n  } catch (error) {\n    dispatch({\n      type: types.LOAD_USER_FAILED\n    });\n  }\n}; //login with email\n\nexport const loginActionWithEmail = payload => async dispatch => {\n  dispatch({\n    type: types.LOGIN_SUCCESSS,\n    payload\n  });\n  dispatch(push('/'));\n  dispatch(getUserAction());\n}; // login with service\n\nexport const loginActionWithService = (data, service) => async dispatch => {\n  try {\n    dispatch(loadingUser());\n    const res = await loginApi(data, service);\n    dispatch({\n      type: types.LOGIN_SUCCESSS,\n      payload: res.data\n    }); // load user\n\n    const res_user = await getUserApi();\n    dispatch(push('/'));\n    await dispatch(loadUserSuccess(res_user.data));\n  } catch (e) {\n    dispatch({\n      type: types.LOGIN_FAILED\n    });\n  }\n}; //logout\n\nexport const logout = () => async (dispatch, getState) => {\n  try {\n    const refreshToken = getToken('refreshToken');\n\n    if (refreshToken) {\n      await authApi.logout(refreshToken);\n    }\n\n    removeToken();\n    dispatch({\n      type: types.LOGOUT\n    });\n  } catch (error) {}\n};","map":{"version":3,"sources":["/Users/mac3/Desktop/workspace/StoreClient/src/reducers/authState/authAction.ts"],"names":["push","loginApi","authApi","getToken","removeToken","getUserApi","types","loadingUser","type","LOADING","loadUserSuccess","payload","LOAD_USER_SUCCESS","getUserAction","dispatch","getState","res","data","error","LOAD_USER_FAILED","loginActionWithEmail","LOGIN_SUCCESSS","loginActionWithService","service","res_user","e","LOGIN_FAILED","logout","refreshToken","LOGOUT"],"mappings":"AAAA,SAASA,IAAT,QAAqB,wBAArB;AAEA,SAASC,QAAT,QAAkC,WAAlC;AACA,OAAOC,OAAP,MAAoB,oBAApB;AACA,SAASC,QAAT,EAAmBC,WAAnB,QAAsC,iBAAtC;AACA,SAASC,UAAT,QAA2B,gBAA3B;AACA,OAAOC,KAAP,MAAkB,aAAlB,C,CAEA;;AACA,MAAMC,WAAW,GAAG,OAAO;AAAEC,EAAAA,IAAI,EAAEF,KAAK,CAACG;AAAd,CAAP,CAApB;;AAEA,OAAO,MAAMC,eAAe,GAAIC,OAAD,KAAmB;AAC9CH,EAAAA,IAAI,EAAEF,KAAK,CAACM,iBADkC;AAE9CD,EAAAA;AAF8C,CAAnB,CAAxB;AAKP,OAAO,MAAME,aAAa,GAAG,MAAM,OAAOC,QAAP,EAAgCC,QAAhC,KAAkD;AACjF,MAAI;AACAD,IAAAA,QAAQ,CAACP,WAAW,EAAZ,CAAR;AAEA,UAAMS,GAAG,GAAG,MAAMX,UAAU,EAA5B;AAEA,UAAMS,QAAQ,CAACJ,eAAe,CAACM,GAAG,CAACC,IAAL,CAAhB,CAAd;AACH,GAND,CAME,OAAOC,KAAP,EAAc;AACZJ,IAAAA,QAAQ,CAAC;AACLN,MAAAA,IAAI,EAAEF,KAAK,CAACa;AADP,KAAD,CAAR;AAGH;AACJ,CAZM,C,CAcP;;AACA,OAAO,MAAMC,oBAAoB,GAAIT,OAAD,IAAkB,MAAOG,QAAP,IAAyB;AAC3EA,EAAAA,QAAQ,CAAC;AACLN,IAAAA,IAAI,EAAEF,KAAK,CAACe,cADP;AAELV,IAAAA;AAFK,GAAD,CAAR;AAKAG,EAAAA,QAAQ,CAACd,IAAI,CAAC,GAAD,CAAL,CAAR;AACAc,EAAAA,QAAQ,CAACD,aAAa,EAAd,CAAR;AACH,CARM,C,CAUP;;AACA,OAAO,MAAMS,sBAAsB,GAAG,CAACL,IAAD,EAAgBM,OAAhB,KAAkC,MAAOT,QAAP,IAAyB;AAC7F,MAAI;AACAA,IAAAA,QAAQ,CAACP,WAAW,EAAZ,CAAR;AACA,UAAMS,GAAG,GAAG,MAAMf,QAAQ,CAACgB,IAAD,EAAOM,OAAP,CAA1B;AAEAT,IAAAA,QAAQ,CAAC;AACLN,MAAAA,IAAI,EAAEF,KAAK,CAACe,cADP;AAELV,MAAAA,OAAO,EAAEK,GAAG,CAACC;AAFR,KAAD,CAAR,CAJA,CASA;;AACA,UAAMO,QAAQ,GAAG,MAAMnB,UAAU,EAAjC;AACAS,IAAAA,QAAQ,CAACd,IAAI,CAAC,GAAD,CAAL,CAAR;AACA,UAAMc,QAAQ,CAACJ,eAAe,CAACc,QAAQ,CAACP,IAAV,CAAhB,CAAd;AACH,GAbD,CAaE,OAAOQ,CAAP,EAAU;AACRX,IAAAA,QAAQ,CAAC;AACLN,MAAAA,IAAI,EAAEF,KAAK,CAACoB;AADP,KAAD,CAAR;AAGH;AACJ,CAnBM,C,CAqBP;;AACA,OAAO,MAAMC,MAAM,GAAG,MAAM,OAAOb,QAAP,EAAsBC,QAAtB,KAAwC;AAChE,MAAI;AACA,UAAMa,YAAY,GAAGzB,QAAQ,CAAC,cAAD,CAA7B;;AAEA,QAAIyB,YAAJ,EAAkB;AACd,YAAM1B,OAAO,CAACyB,MAAR,CAAeC,YAAf,CAAN;AACH;;AAEDxB,IAAAA,WAAW;AAEXU,IAAAA,QAAQ,CAAC;AACLN,MAAAA,IAAI,EAAEF,KAAK,CAACuB;AADP,KAAD,CAAR;AAGH,GAZD,CAYE,OAAOX,KAAP,EAAc,CAAE;AACrB,CAdM","sourcesContent":["import { push } from 'connected-react-router';\nimport { Dispatch } from 'redux';\nimport { loginApi, Payload } from '../../api';\nimport authApi from '../../api/auth-api';\nimport { getToken, removeToken } from '../../api/token';\nimport { getUserApi } from '../../api/user';\nimport types from './authTypes';\n\n// load user\nconst loadingUser = () => ({ type: types.LOADING });\n\nexport const loadUserSuccess = (payload: any) => ({\n    type: types.LOAD_USER_SUCCESS,\n    payload,\n});\n\nexport const getUserAction = () => async (dispatch: Dispatch<any>, getState: any) => {\n    try {\n        dispatch(loadingUser());\n\n        const res = await getUserApi();\n\n        await dispatch(loadUserSuccess(res.data));\n    } catch (error) {\n        dispatch({\n            type: types.LOAD_USER_FAILED,\n        });\n    }\n};\n\n//login with email\nexport const loginActionWithEmail = (payload: any) => async (dispatch: any) => {\n    dispatch({\n        type: types.LOGIN_SUCCESSS,\n        payload,\n    });\n\n    dispatch(push('/'));\n    dispatch(getUserAction());\n};\n\n// login with service\nexport const loginActionWithService = (data: Payload, service?: any) => async (dispatch: any) => {\n    try {\n        dispatch(loadingUser());\n        const res = await loginApi(data, service);\n\n        dispatch({\n            type: types.LOGIN_SUCCESSS,\n            payload: res.data,\n        });\n\n        // load user\n        const res_user = await getUserApi();\n        dispatch(push('/'));\n        await dispatch(loadUserSuccess(res_user.data));\n    } catch (e) {\n        dispatch({\n            type: types.LOGIN_FAILED,\n        });\n    }\n};\n\n//logout\nexport const logout = () => async (dispatch: any, getState: any) => {\n    try {\n        const refreshToken = getToken('refreshToken');\n\n        if (refreshToken) {\n            await authApi.logout(refreshToken);\n        }\n\n        removeToken();\n\n        dispatch({\n            type: types.LOGOUT,\n        });\n    } catch (error) {}\n};\n"]},"metadata":{},"sourceType":"module"}