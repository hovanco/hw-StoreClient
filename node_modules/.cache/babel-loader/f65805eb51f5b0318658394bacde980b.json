{"ast":null,"code":"var _jsxFileName = \"/Users/mac3/Desktop/workspace/StoreClient/src/pages/product/product-list/index.tsx\",\n    _s = $RefreshSig$();\n\nimport { CaretDownOutlined } from '@ant-design/icons';\nimport { Checkbox, Col, Dropdown, Input, Modal, Row, Select, Space, Typography, message, Menu } from 'antd';\nimport { debounce, isNil, omit } from 'lodash';\nimport * as queryString from 'query-string';\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link, useHistory } from 'react-router-dom';\nimport productApi from '../../../api/product-api';\nimport iconPlus from \"../../../assets/images/ic-plus.svg\";\nimport { InsaButton, InsaTable, PageTopWrapper } from '../../../components';\nimport formatMoney from '../../../helper/format-money';\nimport { DefaultLayout } from '../../../layout';\nimport { storeAction } from '../../../reducers/storeState/action';\nimport theme from '../../../theme';\nimport ProductColumnName from '../product-column-name';\nimport '../style.less';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst ProductList = () => {\n  _s();\n\n  const history = useHistory();\n  const dispatch = useDispatch();\n  const isCollapsed = useSelector(state => state.global.isCollapsed);\n  const {\n    data: storeObj,\n    product,\n    categories\n  } = useSelector(({\n    store\n  }) => store);\n  const {\n    data: productList,\n    loading,\n    pagination\n  } = product;\n  const [page, setPage] = useState(1);\n  const [limit, setLimit] = useState(20);\n  const [path, setPath] = useState(history.location.search);\n  const [loadingRemoveProducts, setLoadingRemoveProducts] = useState(false);\n  const [widthTable, setWidthTable] = useState(0);\n  const filterState = queryString.parse(history.location.search);\n  useEffect(() => {\n    setPath(history.location.search);\n  }, [history.location.search]);\n  const columns = [{\n    title: 'Tên sản phẩm',\n    dataIndex: 'name',\n    key: 'name',\n    width: 340,\n    align: 'center',\n    render: (text, record) => /*#__PURE__*/_jsxDEV(ProductColumnName, {\n      text: text,\n      onClick: () => history.push(`/products/detail/${record._id}`),\n      product: record\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 17\n    }, this)\n  }, {\n    title: 'Mã sản phẩm',\n    className: 'column-money',\n    dataIndex: 'code',\n    key: 'code',\n    align: 'center'\n  }, {\n    title: 'Số lượng',\n    key: '_id',\n    align: 'center',\n    render: product => {\n      if (product.isVariant) {\n        return /*#__PURE__*/_jsxDEV(\"span\", {\n          children: product.quantity\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 28\n        }, this);\n      } else {\n        const totalQuantity = (product.variants || []).reduce((total, {\n          quantity\n        }) => total + (quantity || 0), 0);\n        return /*#__PURE__*/_jsxDEV(\"span\", {\n          children: totalQuantity\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 28\n        }, this);\n      }\n    }\n  }, {\n    title: 'Đơn giá',\n    dataIndex: 'originalPrice',\n    key: 'originalPrice',\n    align: 'center',\n    render: text => text ? /*#__PURE__*/_jsxDEV(Typography.Text, {\n      className: \"product-tbl__text-round\",\n      children: [formatMoney(text), \" \\u0111\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 21\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false)\n  }];\n\n  const fetchDataCallback = currentFilterState => {\n    const _filterState = isNil(currentFilterState) ? filterState : currentFilterState;\n\n    if (storeObj._id) {\n      dispatch(storeAction.getProduct({\n        id: storeObj._id,\n        limit,\n        page,\n        categoryId: _filterState.categoryId,\n        search: _filterState.search,\n        withQuantity: true\n      }));\n    }\n  };\n\n  const fetchDataDebounce = debounce(fetchDataCallback, 500);\n\n  const changeTextSearch = e => {\n    const nextFilterState = { ...filterState,\n      search: e.target.value\n    };\n    history.push({\n      search: queryString.stringify(nextFilterState)\n    });\n  };\n\n  const handleSearch = async value => {\n    const nextFilterState = { ...filterState,\n      search: value\n    };\n    await setPage(1);\n    fetchDataDebounce(nextFilterState);\n  };\n\n  const handleSelectCategory = async id => {\n    let nextFilterState = filterState;\n\n    if (id === 'root') {\n      nextFilterState = omit(nextFilterState, 'categoryId');\n    } else {\n      nextFilterState.categoryId = id;\n    }\n\n    history.push({\n      search: queryString.stringify(nextFilterState)\n    });\n    await setPage(1);\n    fetchDataCallback(nextFilterState);\n  };\n\n  const onChangPagination = (pageNumber, pageSize) => {\n    setPage(pageNumber);\n    setLimit(pageSize || 20);\n  };\n\n  const [selectedRowKeys, setSelectedRowKeys] = useState([]);\n\n  const onSelectChange = selectedRowKeysInCurrentPage => {\n    let selectedRowKeysBeforeInCurrentPage = [];\n    productList.forEach(product => {\n      if (selectedRowKeys.includes(product._id)) {\n        selectedRowKeysBeforeInCurrentPage.push(product._id);\n      }\n    });\n    const selectedRowInOtherPage = selectedRowKeys.filter(key => !selectedRowKeysBeforeInCurrentPage.includes(key));\n    setSelectedRowKeys([...selectedRowInOtherPage, ...selectedRowKeysInCurrentPage]);\n  };\n\n  const selectAll = () => {\n    const productKeys = productList.map(product => product._id);\n    setSelectedRowKeys(productKeys);\n  };\n\n  const removeAllSelect = () => {\n    setSelectedRowKeys([]);\n  };\n\n  const removeOrderSelect = () => {\n    Modal.confirm({\n      title: 'Xóa Sản Phẩm?',\n      content: `Bạn chắc chắn muốn xóa sản phẩm?`,\n      okText: 'Xóa',\n      okType: 'danger',\n      cancelText: 'Hủy',\n\n      onOk() {\n        if (storeObj._id) {\n          setLoadingRemoveProducts(true);\n          Promise.all(selectedRowKeys.map(async productId => {\n            await productApi.deleteProduct(storeObj._id, productId);\n            return true;\n          })).then(() => {\n            message.success(`Đã xóa ${selectedRowKeys.length} sản phẩm`);\n            setSelectedRowKeys([]);\n            fetchDataCallback(filterState);\n          }).catch(error => {\n            message.error('Lỗi xóa sản phẩm');\n          }).finally(() => {\n            setLoadingRemoveProducts(false);\n          });\n        }\n      }\n\n    });\n  };\n\n  function handleMenuClick(e) {\n    switch (e.key) {\n      case 'remove':\n        removeOrderSelect();\n        break;\n\n      case 'unselect':\n        setSelectedRowKeys([]);\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  const menu = /*#__PURE__*/_jsxDEV(Menu, {\n    onClick: handleMenuClick,\n    children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n      children: \"X\\xF3a s\\u1EA3n ph\\u1EA9m\"\n    }, \"remove\", false, {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Menu.Item, {\n      children: \"B\\u1ECF ch\\u1ECDn\"\n    }, \"unselect\", false, {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 228,\n    columnNumber: 9\n  }, this);\n\n  const renderColumnTitle = () => {\n    if (selectedRowKeys.length === 0) {\n      return /*#__PURE__*/_jsxDEV(Checkbox, {\n        onClick: selectAll\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 20\n      }, this);\n    }\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        bottom: 0,\n        right: 0,\n        background: '#fff',\n        display: 'flex',\n        alignItems: 'center',\n        paddingLeft: 10,\n        zIndex: 100,\n        width: widthTable\n      },\n      children: /*#__PURE__*/_jsxDEV(Dropdown.Button, {\n        overlay: menu,\n        buttonsRender: ([leftButton, rightButton]) => [leftButton, /*#__PURE__*/React.cloneElement(rightButton, {\n          children: /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [\"Ch\\u1ECDn thao t\\xE1c \", /*#__PURE__*/_jsxDEV(CaretDownOutlined, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 51\n            }, this)]\n          }, void 0, true),\n          loading: loadingRemoveProducts,\n          icon: undefined\n        })],\n        children: /*#__PURE__*/_jsxDEV(Space, {\n          children: [/*#__PURE__*/_jsxDEV(Checkbox, {\n            onClick: removeAllSelect,\n            checked: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [\"\\u0110\\xE3 ch\\u1ECDn \", selectedRowKeys.length, \" s\\u1EA3n ph\\u1EA9m\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 13\n    }, this);\n  };\n\n  const rowSelection = {\n    selectedRowKeys,\n    onChange: onSelectChange,\n    columnTitle: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: 30\n      },\n      children: renderColumnTitle()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 22\n    }, this)\n  };\n  useEffect(() => {\n    if (storeObj._id) {\n      fetchDataDebounce();\n      dispatch(storeAction.getCategoriesByStore(storeObj._id));\n    } // eslint-disable-next-line\n\n  }, [storeObj._id, page, limit]);\n  useEffect(() => {\n    var _document;\n\n    const antTableHeadEle = (_document = document) === null || _document === void 0 ? void 0 : _document.querySelector('.product-tbl .ant-table-thead');\n    let productActionsWidth = antTableHeadEle ? antTableHeadEle.clientWidth : 0;\n    setWidthTable(productActionsWidth);\n  }, [selectedRowKeys]);\n  useEffect(() => {\n    if (selectedRowKeys.length > 0) {\n      setWidthTable(isCollapsed ? widthTable + 120 : widthTable - 120);\n    }\n  }, [isCollapsed]);\n\n  const headerTableProduct = /*#__PURE__*/_jsxDEV(Space, {\n    size: \"middle\",\n    children: [/*#__PURE__*/_jsxDEV(Input.Search, {\n      placeholder: \"T\\xECm ki\\u1EBFm s\\u1EA3n ph\\u1EA9m\",\n      onChange: changeTextSearch,\n      onSearch: handleSearch,\n      style: {\n        width: 330\n      },\n      value: filterState.search || '',\n      allowClear: true\n    }, \"search\", false, {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Select, {\n      style: {\n        minWidth: 200\n      },\n      value: filterState.categoryId || 'root',\n      onChange: handleSelectCategory,\n      children: [/*#__PURE__*/_jsxDEV(Select.Option, {\n        value: \"root\",\n        children: \"L\\u1ECDc s\\u1EA3n ph\\u1EA9m\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 17\n      }, this), categories.map(cate => /*#__PURE__*/_jsxDEV(Select.Option, {\n        value: cate._id,\n        children: cate.name\n      }, cate._id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 21\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 309,\n    columnNumber: 9\n  }, this);\n\n  return /*#__PURE__*/_jsxDEV(DefaultLayout, {\n    title: \"Danh s\\xE1ch s\\u1EA3n ph\\u1EA9m\",\n    children: [/*#__PURE__*/_jsxDEV(PageTopWrapper, {\n      leftContent: /*#__PURE__*/_jsxDEV(Typography.Title, {\n        level: 3,\n        children: \"Danh s\\xE1ch s\\u1EA3n ph\\u1EA9m\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 30\n      }, this),\n      rightContent: /*#__PURE__*/_jsxDEV(Space, {\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          to: \"new\",\n          children: /*#__PURE__*/_jsxDEV(InsaButton, {\n            type: \"primary\",\n            icon: /*#__PURE__*/_jsxDEV(\"img\", {\n              style: {\n                marginRight: 10\n              },\n              src: iconPlus,\n              alt: \"icon\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 343,\n              columnNumber: 39\n            }, this),\n            children: \"Th\\xEAm s\\u1EA3n ph\\u1EA9m\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      style: {\n        padding: theme.spacing.m\n      },\n      children: /*#__PURE__*/_jsxDEV(Col, {\n        span: 24,\n        children: /*#__PURE__*/_jsxDEV(InsaTable, {\n          name: \"Danh s\\xE1ch s\\u1EA3n ph\\u1EA9m\",\n          loading: loading,\n          columns: columns,\n          isShowTotal: true,\n          rowKey: \"_id\",\n          rowSelection: rowSelection,\n          dataSource: productList.map(e => ({ ...e,\n            key: e._id\n          })),\n          pagination: {\n            pageSize: limit,\n            current: page,\n            total: pagination.total,\n            onChange: onChangPagination\n          },\n          bordered: true,\n          hasDefaultColumn: false,\n          className: \"product-tbl\",\n          headerExtend: headerTableProduct,\n          onRow: record => {\n            return {\n              onClick: event => {\n                history.push(`/products/detail/${record._id}`, path);\n              }\n            };\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 376,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 375,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 370,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 335,\n    columnNumber: 9\n  }, this);\n};\n\n_s(ProductList, \"sk0ip4f6sVBQLyARfnm7tO1I9t8=\", false, function () {\n  return [useHistory, useDispatch, useSelector, useSelector];\n});\n\n_c = ProductList;\nexport default ProductList;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductList\");","map":{"version":3,"sources":["/Users/mac3/Desktop/workspace/StoreClient/src/pages/product/product-list/index.tsx"],"names":["CaretDownOutlined","Checkbox","Col","Dropdown","Input","Modal","Row","Select","Space","Typography","message","Menu","debounce","isNil","omit","queryString","React","useEffect","useState","useDispatch","useSelector","Link","useHistory","productApi","InsaButton","InsaTable","PageTopWrapper","formatMoney","DefaultLayout","storeAction","theme","ProductColumnName","ProductList","history","dispatch","isCollapsed","state","global","data","storeObj","product","categories","store","productList","loading","pagination","page","setPage","limit","setLimit","path","setPath","location","search","loadingRemoveProducts","setLoadingRemoveProducts","widthTable","setWidthTable","filterState","parse","columns","title","dataIndex","key","width","align","render","text","record","push","_id","className","isVariant","quantity","totalQuantity","variants","reduce","total","fetchDataCallback","currentFilterState","_filterState","getProduct","id","categoryId","withQuantity","fetchDataDebounce","changeTextSearch","e","nextFilterState","target","value","stringify","handleSearch","handleSelectCategory","onChangPagination","pageNumber","pageSize","selectedRowKeys","setSelectedRowKeys","onSelectChange","selectedRowKeysInCurrentPage","selectedRowKeysBeforeInCurrentPage","forEach","includes","selectedRowInOtherPage","filter","selectAll","productKeys","map","removeAllSelect","removeOrderSelect","confirm","content","okText","okType","cancelText","onOk","Promise","all","productId","deleteProduct","then","success","length","catch","error","finally","handleMenuClick","menu","renderColumnTitle","position","top","left","bottom","right","background","display","alignItems","paddingLeft","zIndex","leftButton","rightButton","cloneElement","children","icon","undefined","rowSelection","onChange","columnTitle","getCategoriesByStore","antTableHeadEle","document","querySelector","productActionsWidth","clientWidth","headerTableProduct","minWidth","cate","name","marginRight","iconPlus","padding","spacing","m","current","onClick","event"],"mappings":"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","sourcesContent":["import { CaretDownOutlined } from '@ant-design/icons';\nimport { Checkbox, Col, Dropdown, Input, Modal, Row, Select, Space, Typography, message, Menu } from 'antd';\nimport { ColumnType } from 'antd/lib/table';\nimport { debounce, isNil, omit } from 'lodash';\nimport * as queryString from 'query-string';\nimport React, { FC, ReactElement, useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link, useHistory } from 'react-router-dom';\nimport productApi from '../../../api/product-api';\nimport iconDownload from '../../../assets/images/ic-download.svg';\nimport iconPlus from '../../../assets/images/ic-plus.svg';\nimport iconUpload from '../../../assets/images/ic-upload.svg';\nimport { InsaButton, InsaTable, PageTopWrapper } from '../../../components';\nimport formatMoney from '../../../helper/format-money';\nimport { DefaultLayout } from '../../../layout';\nimport { IProduct } from '../../../models';\nimport { storeAction } from '../../../reducers/storeState/action';\nimport { IStoreState } from '../../../reducers/storeState/reducer';\nimport { IState } from '../../../store/rootReducer';\nimport theme from '../../../theme';\nimport ProductColumnName from '../product-column-name';\nimport '../style.less';\n\nconst ProductList: FC = () => {\n    const history = useHistory();\n    const dispatch = useDispatch();\n    const isCollapsed = useSelector((state: IState) => state.global.isCollapsed);\n    const { data: storeObj, product, categories } = useSelector(\n        ({ store }: { store: IStoreState }) => store\n    );\n    const { data: productList, loading, pagination } = product;\n    const [page, setPage] = useState(1);\n    const [limit, setLimit] = useState(20);\n    const [path, setPath] = useState(history.location.search);\n\n    const [loadingRemoveProducts, setLoadingRemoveProducts] = useState<boolean>(false);\n    const [widthTable, setWidthTable] = useState<number>(0);\n\n    const filterState: {\n        categoryId?: string;\n        search?: string;\n    } = queryString.parse(history.location.search);\n\n    useEffect(() => {\n        setPath(history.location.search)\n    }, [history.location.search])\n\n    const columns: ColumnType<any>[] = [\n        {\n            title: 'Tên sản phẩm',\n            dataIndex: 'name',\n            key: 'name',\n            width: 340,\n            align: 'center',\n            render: (text: string, record: any) => (\n                <ProductColumnName\n                    text={text}\n                    onClick={() => history.push(`/products/detail/${record._id}`)}\n                    product={record}\n                />\n            ),\n        },\n        {\n            title: 'Mã sản phẩm',\n            className: 'column-money',\n            dataIndex: 'code',\n            key: 'code',\n            align: 'center',\n        },\n        {\n            title: 'Số lượng',\n            key: '_id',\n            align: 'center',\n            render: (product: IProduct) => {\n                if (product.isVariant) {\n                    return <span>{product.quantity}</span>\n                } else {\n                    const totalQuantity = (product.variants || [])\n                        .reduce((total, { quantity }) => total + (quantity || 0), 0);\n                    return <span>{totalQuantity}</span> \n                }\n            },\n        },\n        {\n            title: 'Đơn giá',\n            dataIndex: 'originalPrice',\n            key: 'originalPrice',\n            align: 'center',\n            render: (text: string) =>\n                text ? (\n                    <Typography.Text className=\"product-tbl__text-round\">\n                        {formatMoney(text)} đ\n                    </Typography.Text>\n                ) : (\n                    <></>\n                ),\n        },\n    ];\n\n    const fetchDataCallback = (currentFilterState?: { categoryId?: string; search?: string }) => {\n        const _filterState = isNil(currentFilterState) ? filterState : currentFilterState;\n        if (storeObj._id) {\n            dispatch(\n                storeAction.getProduct({\n                    id: storeObj._id,\n                    limit,\n                    page,\n                    categoryId: _filterState.categoryId as string,\n                    search: _filterState.search as string,\n                    withQuantity: true,\n                })\n            );\n        }\n    };\n\n    const fetchDataDebounce = debounce(fetchDataCallback, 500);\n\n    const changeTextSearch = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const nextFilterState = { ...filterState, search: e.target.value };\n\n        history.push({\n            search: queryString.stringify(nextFilterState),\n        });\n    };\n\n    const handleSearch = async (value: string) => {\n        const nextFilterState = { ...filterState, search: value };\n        await setPage(1);\n        fetchDataDebounce(nextFilterState);\n    };\n\n    const handleSelectCategory = async (id: string): Promise<void> => {\n        let nextFilterState = filterState;\n        if (id === 'root') {\n            nextFilterState = omit(nextFilterState, 'categoryId');\n        } else {\n            nextFilterState.categoryId = id;\n        }\n\n        history.push({\n            search: queryString.stringify(nextFilterState),\n        });\n        await setPage(1);\n        fetchDataCallback(nextFilterState);\n    };\n\n    const onChangPagination = (pageNumber: number, pageSize?: number) => {\n        setPage(pageNumber);\n        setLimit(pageSize || 20);\n    };\n\n    const [selectedRowKeys, setSelectedRowKeys] = useState<any>([]);\n\n    const onSelectChange = (selectedRowKeysInCurrentPage: any) => {\n        let selectedRowKeysBeforeInCurrentPage: string[] =[];  \n        productList.forEach(product => {\n            if (selectedRowKeys.includes(product._id)) {\n                selectedRowKeysBeforeInCurrentPage.push(product._id);\n            }\n        });\n\n        const selectedRowInOtherPage = selectedRowKeys\n            .filter((key: string) => !selectedRowKeysBeforeInCurrentPage.includes(key));\n\n        setSelectedRowKeys([...selectedRowInOtherPage, ...selectedRowKeysInCurrentPage]);\n    };\n\n    const selectAll = () => {\n        const productKeys = productList.map((product: IProduct) => product._id);\n        setSelectedRowKeys(productKeys);\n    };\n\n    const removeAllSelect = () => {\n        setSelectedRowKeys([]);\n    };\n\n    const removeOrderSelect = () => {\n        Modal.confirm({\n            title: 'Xóa Sản Phẩm?',\n            content: `Bạn chắc chắn muốn xóa sản phẩm?`,\n            okText: 'Xóa',\n            okType: 'danger',\n            cancelText: 'Hủy',\n\n            onOk() {\n                if (storeObj._id) {\n                    setLoadingRemoveProducts(true);\n                    Promise.all(\n                        selectedRowKeys.map(async (productId: string) => {\n                            await productApi.deleteProduct(\n                                storeObj._id as string,\n                                productId,\n                            );\n\n                            return true;\n                        })\n                    )\n                        .then(() => {\n                            message.success(`Đã xóa ${selectedRowKeys.length} sản phẩm`);\n                            setSelectedRowKeys([]);\n                            fetchDataCallback(filterState);\n                        })\n                        .catch((error) => {\n                            message.error('Lỗi xóa sản phẩm');\n                        })\n                        .finally(() => {\n                            setLoadingRemoveProducts(false);\n                        });\n                }\n            },\n        });\n    };\n\n    function handleMenuClick(e: any) {\n        switch (e.key) {\n            case 'remove':\n                removeOrderSelect();\n                break;\n            case 'unselect':\n                setSelectedRowKeys([]);\n                break;\n            default:\n                break;\n        }\n    }\n\n    const menu = (\n        <Menu onClick={handleMenuClick}>\n            <Menu.Item key=\"remove\">Xóa sản phẩm</Menu.Item>\n            <Menu.Item key=\"unselect\">Bỏ chọn</Menu.Item>\n        </Menu>\n    );\n\n    const renderColumnTitle = () => {\n        if (selectedRowKeys.length === 0) {\n            return <Checkbox onClick={selectAll} />;\n        }\n\n        return (\n            <div\n                style={{\n                    position: 'absolute',\n                    top: 0,\n                    left: 0,\n                    bottom: 0,\n                    right: 0,\n                    background: '#fff',\n                    display: 'flex',\n                    alignItems: 'center',\n                    paddingLeft: 10,\n                    zIndex: 100,\n                    width: widthTable,\n                }}\n            >\n                <Dropdown.Button\n                    overlay={menu}\n                    buttonsRender={([leftButton, rightButton]) => [\n                        leftButton,\n                        React.cloneElement(rightButton as ReactElement, {\n                            children: (\n                                <>\n                                    Chọn thao tác <CaretDownOutlined />\n                                </>\n                            ),\n                            loading: loadingRemoveProducts,\n                            icon: undefined,\n                        }),\n                    ]}\n                >\n                    <Space>\n                        <Checkbox onClick={removeAllSelect} checked />\n                        <span>Đã chọn {selectedRowKeys.length} sản phẩm</span>\n                    </Space>\n                </Dropdown.Button>\n            </div>\n        );\n    };\n\n    const rowSelection = {\n        selectedRowKeys,\n        onChange: onSelectChange,\n        columnTitle: <div style={{ width: 30 }}>{renderColumnTitle()}</div>,\n    };\n\n    useEffect(() => {\n        if (storeObj._id) {\n            fetchDataDebounce();\n            dispatch(storeAction.getCategoriesByStore(storeObj._id));\n        }\n        // eslint-disable-next-line\n    }, [storeObj._id, page, limit]);\n\n    useEffect(() => {\n        const antTableHeadEle: HTMLTableHeaderCellElement | null = document?.querySelector(\n            '.product-tbl .ant-table-thead'\n        );\n        let productActionsWidth: number = antTableHeadEle ? antTableHeadEle.clientWidth : 0;\n\n        setWidthTable(productActionsWidth);\n    }, [selectedRowKeys]);\n\n    useEffect(() => {\n        if (selectedRowKeys.length > 0) {\n            setWidthTable(isCollapsed ? widthTable + 120 : widthTable - 120);\n        }\n    }, [isCollapsed]);\n\n    const headerTableProduct = (\n        <Space size=\"middle\">\n            <Input.Search\n                key=\"search\"\n                placeholder=\"Tìm kiếm sản phẩm\"\n                onChange={changeTextSearch}\n                onSearch={handleSearch}\n                style={{ width: 330 }}\n                value={filterState.search || ''}\n                allowClear\n            />\n            <Select\n                style={{ minWidth: 200 }}\n                value={filterState.categoryId || 'root'}\n                onChange={handleSelectCategory}\n            >\n                <Select.Option value=\"root\">Lọc sản phẩm</Select.Option>\n                {categories.map((cate) => (\n                    <Select.Option key={cate._id} value={cate._id}>\n                        {cate.name}\n                    </Select.Option>\n                ))}\n            </Select>\n        </Space>\n    );\n\n    return (\n        <DefaultLayout title=\"Danh sách sản phẩm\">\n            <PageTopWrapper\n                leftContent={<Typography.Title level={3}>Danh sách sản phẩm</Typography.Title>}\n                rightContent={\n                    <Space>\n                        <Link to=\"new\">\n                            <InsaButton\n                                type=\"primary\"\n                                icon={<img style={{ marginRight: 10 }} src={iconPlus} alt=\"icon\" />}\n                            >\n                                Thêm sản phẩm\n                            </InsaButton>\n                        </Link>\n                        {/* TODO: Show after add feature */}\n                        {/* <InsaButton shape=\"circle\" icon={<ExclamationOutlined />} /> */}\n                    </Space>\n                }\n            />\n\n            {/* TODO: Show after add feature */}\n            {/* <Row justify=\"end\" align=\"middle\" style={{ height: 74, paddingRight: theme.spacing.m }}>\n                <Space>\n                    <InsaButton\n                        icon={<img style={{ marginRight: 10 }} src={iconDownload} alt=\"icon\" />}\n                    >\n                        <Typography.Text type=\"secondary\">Nhập file</Typography.Text>\n                    </InsaButton>\n                    <InsaButton\n                        icon={<img style={{ marginRight: 10 }} src={iconUpload} alt=\"icon\" />}\n                    >\n                        <Typography.Text type=\"secondary\">Xuất file</Typography.Text>\n                    </InsaButton>\n                </Space>\n            </Row> */}\n\n            <Row\n                style={{\n                    padding: theme.spacing.m,\n                }}\n            >\n                <Col span={24}>\n                    <InsaTable\n                        name=\"Danh sách sản phẩm\"\n                        loading={loading}\n                        columns={columns}\n                        isShowTotal\n                        rowKey=\"_id\"\n                        rowSelection={rowSelection}\n                        dataSource={productList.map((e) => ({\n                            ...e,\n                            key: e._id,\n                        }))}\n                        pagination={{\n                            pageSize: limit,\n                            current: page,\n                            total: pagination.total,\n                            onChange: onChangPagination,\n                        }}\n                        bordered\n                        hasDefaultColumn={false}\n                        className=\"product-tbl\"\n                        headerExtend={headerTableProduct}\n                        onRow={(record) => {\n                            return {\n                                onClick: (event) => {\n                                    history.push(`/products/detail/${(record as IProduct)._id}`, path);\n                                },\n                            };\n                        }}\n                    />\n                </Col>\n            </Row>\n        </DefaultLayout>\n    );\n};\n\nexport default ProductList;\n"]},"metadata":{},"sourceType":"module"}